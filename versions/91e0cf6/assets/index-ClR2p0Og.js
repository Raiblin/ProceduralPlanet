var K=Object.defineProperty;var Z=(r,e,t)=>e in r?K(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var B=(r,e,t)=>Z(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var N=1e-6,L=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});function T(){var r=new L(16);return L!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function J(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function q(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function W(r,e,t){var i=e[0],n=e[1],s=e[2],a=e[3],o=e[4],l=e[5],d=e[6],c=e[7],h=e[8],g=e[9],v=e[10],R=e[11],M=e[12],x=e[13],y=e[14],_=e[15],A=t[0],f=t[1],m=t[2],p=t[3];return r[0]=A*i+f*o+m*h+p*M,r[1]=A*n+f*l+m*g+p*x,r[2]=A*s+f*d+m*v+p*y,r[3]=A*a+f*c+m*R+p*_,A=t[4],f=t[5],m=t[6],p=t[7],r[4]=A*i+f*o+m*h+p*M,r[5]=A*n+f*l+m*g+p*x,r[6]=A*s+f*d+m*v+p*y,r[7]=A*a+f*c+m*R+p*_,A=t[8],f=t[9],m=t[10],p=t[11],r[8]=A*i+f*o+m*h+p*M,r[9]=A*n+f*l+m*g+p*x,r[10]=A*s+f*d+m*v+p*y,r[11]=A*a+f*c+m*R+p*_,A=t[12],f=t[13],m=t[14],p=t[15],r[12]=A*i+f*o+m*h+p*M,r[13]=A*n+f*l+m*g+p*x,r[14]=A*s+f*d+m*v+p*y,r[15]=A*a+f*c+m*R+p*_,r}function Q(r,e,t){var i=t[0],n=t[1],s=t[2],a,o,l,d,c,h,g,v,R,M,x,y;return e===r?(r[12]=e[0]*i+e[4]*n+e[8]*s+e[12],r[13]=e[1]*i+e[5]*n+e[9]*s+e[13],r[14]=e[2]*i+e[6]*n+e[10]*s+e[14],r[15]=e[3]*i+e[7]*n+e[11]*s+e[15]):(a=e[0],o=e[1],l=e[2],d=e[3],c=e[4],h=e[5],g=e[6],v=e[7],R=e[8],M=e[9],x=e[10],y=e[11],r[0]=a,r[1]=o,r[2]=l,r[3]=d,r[4]=c,r[5]=h,r[6]=g,r[7]=v,r[8]=R,r[9]=M,r[10]=x,r[11]=y,r[12]=a*i+c*n+R*s+e[12],r[13]=o*i+h*n+M*s+e[13],r[14]=l*i+g*n+x*s+e[14],r[15]=d*i+v*n+y*s+e[15]),r}function j(r,e,t,i){var n=i[0],s=i[1],a=i[2],o=Math.hypot(n,s,a),l,d,c,h,g,v,R,M,x,y,_,A,f,m,p,E,I,P,D,U,Y,C,z,O;return o<N?null:(o=1/o,n*=o,s*=o,a*=o,l=Math.sin(t),d=Math.cos(t),c=1-d,h=e[0],g=e[1],v=e[2],R=e[3],M=e[4],x=e[5],y=e[6],_=e[7],A=e[8],f=e[9],m=e[10],p=e[11],E=n*n*c+d,I=s*n*c+a*l,P=a*n*c-s*l,D=n*s*c-a*l,U=s*s*c+d,Y=a*s*c+n*l,C=n*a*c+s*l,z=s*a*c-n*l,O=a*a*c+d,r[0]=h*E+M*I+A*P,r[1]=g*E+x*I+f*P,r[2]=v*E+y*I+m*P,r[3]=R*E+_*I+p*P,r[4]=h*D+M*U+A*Y,r[5]=g*D+x*U+f*Y,r[6]=v*D+y*U+m*Y,r[7]=R*D+_*U+p*Y,r[8]=h*C+M*z+A*O,r[9]=g*C+x*z+f*O,r[10]=v*C+y*z+m*O,r[11]=R*C+_*z+p*O,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function ee(r,e,t){var i=Math.sin(t),n=Math.cos(t),s=e[4],a=e[5],o=e[6],l=e[7],d=e[8],c=e[9],h=e[10],g=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=s*n+d*i,r[5]=a*n+c*i,r[6]=o*n+h*i,r[7]=l*n+g*i,r[8]=d*n-s*i,r[9]=c*n-a*i,r[10]=h*n-o*i,r[11]=g*n-l*i,r}function re(r,e,t){var i=Math.sin(t),n=Math.cos(t),s=e[0],a=e[1],o=e[2],l=e[3],d=e[8],c=e[9],h=e[10],g=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*n-d*i,r[1]=a*n-c*i,r[2]=o*n-h*i,r[3]=l*n-g*i,r[8]=s*i+d*n,r[9]=a*i+c*n,r[10]=o*i+h*n,r[11]=l*i+g*n,r}function te(r,e,t){var i=Math.sin(t),n=Math.cos(t),s=e[0],a=e[1],o=e[2],l=e[3],d=e[4],c=e[5],h=e[6],g=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=s*n+d*i,r[1]=a*n+c*i,r[2]=o*n+h*i,r[3]=l*n+g*i,r[4]=d*n-s*i,r[5]=c*n-a*i,r[6]=h*n-o*i,r[7]=g*n-l*i,r}function ie(r,e,t,i,n){var s=1/Math.tan(e/2),a;return r[0]=s/t,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=s,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,n!=null&&n!==1/0?(a=1/(i-n),r[10]=(n+i)*a,r[14]=2*n*i*a):(r[10]=-1,r[14]=-2*i),r}var k=ie;function ne(r,e,t,i){var n,s,a,o,l,d,c,h,g,v,R=e[0],M=e[1],x=e[2],y=i[0],_=i[1],A=i[2],f=t[0],m=t[1],p=t[2];return Math.abs(R-f)<N&&Math.abs(M-m)<N&&Math.abs(x-p)<N?q(r):(c=R-f,h=M-m,g=x-p,v=1/Math.hypot(c,h,g),c*=v,h*=v,g*=v,n=_*g-A*h,s=A*c-y*g,a=y*h-_*c,v=Math.hypot(n,s,a),v?(v=1/v,n*=v,s*=v,a*=v):(n=0,s=0,a=0),o=h*a-g*s,l=g*n-c*a,d=c*s-h*n,v=Math.hypot(o,l,d),v?(v=1/v,o*=v,l*=v,d*=v):(o=0,l=0,d=0),r[0]=n,r[1]=o,r[2]=c,r[3]=0,r[4]=s,r[5]=l,r[6]=h,r[7]=0,r[8]=a,r[9]=d,r[10]=g,r[11]=0,r[12]=-(n*R+s*M+a*x),r[13]=-(o*R+l*M+d*x),r[14]=-(c*R+h*M+g*x),r[15]=1,r)}function w(){var r=new L(3);return L!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function G(r){var e=new L(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function se(r){var e=r[0],t=r[1],i=r[2];return Math.hypot(e,t,i)}function F(r,e,t){var i=new L(3);return i[0]=r,i[1]=e,i[2]=t,i}function ae(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}function H(r,e,t,i){return r[0]=e,r[1]=t,r[2]=i,r}function u(r,e,t){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function V(r,e,t){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function b(r,e,t){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function S(r,e){var t=e[0],i=e[1],n=e[2],s=t*t+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),r[0]=e[0]*s,r[1]=e[1]*s,r[2]=e[2]*s,r}function X(r,e,t){var i=e[0],n=e[1],s=e[2],a=t[0],o=t[1],l=t[2];return r[0]=n*l-s*o,r[1]=s*a-i*l,r[2]=i*o-n*a,r}function $(r,e,t){var i=e[0],n=e[1],s=e[2],a=t[3]*i+t[7]*n+t[11]*s+t[15];return a=a||1,r[0]=(t[0]*i+t[4]*n+t[8]*s+t[12])/a,r[1]=(t[1]*i+t[5]*n+t[9]*s+t[13])/a,r[2]=(t[2]*i+t[6]*n+t[10]*s+t[14])/a,r}(function(){var r=w();return function(e,t,i,n,s,a){var o,l;for(t||(t=3),i||(i=0),n?l=Math.min(n*t+i,e.length):l=e.length,o=i;o<l;o+=t)r[0]=e[o],r[1]=e[o+1],r[2]=e[o+2],s(r,r,a),e[o]=r[0],e[o+1]=r[1],e[o+2]=r[2];return e}})();class oe{constructor(e,t,i,n){B(this,"projectionMatrix");B(this,"viewMatrix");B(this,"modelMatrix");B(this,"position");B(this,"target");B(this,"up");B(this,"velocity");this.projectionMatrix=T(),k(this.projectionMatrix,e,t,i,n),this.viewMatrix=T(),this.modelMatrix=T(),this.position=F(0,0,2),this.target=F(0,0,0),this.up=F(0,1,0),this.velocity=w(),this.updateViewMatrix()}updateViewMatrix(){ne(this.viewMatrix,this.position,this.target,this.up)}updateProjectionMatrix(e){k(this.projectionMatrix,Math.PI/4,e,.1,10)}getFinalMatrix(){const e=T();return W(e,this.projectionMatrix,this.viewMatrix),W(e,e,this.modelMatrix),e}setModelMatrix(e){J(this.modelMatrix,e)}moveForward(e){const t=w();V(t,this.target,this.position),S(t,t),b(t,t,e),u(this.velocity,this.velocity,t)}moveBackward(e){this.moveForward(-e)}moveLeft(e){const t=w();X(t,this.up,V(w(),this.target,this.position)),S(t,t),b(t,t,e),u(this.velocity,this.velocity,t)}moveRight(e){this.moveLeft(-e)}lookAt(e){ae(this.target,e),this.updateViewMatrix()}rotate(e,t){const i=w();V(i,this.target,this.position);const n=se(i),s=e*.01,a=t*.01,o=this.up,l=w();X(l,i,this.up),S(l,l);const d=T();j(d,d,s,o);const c=T();j(c,c,a,l),$(i,i,d),$(i,i,c),S(i,i),b(i,i,n),u(this.target,this.position,i),this.updateViewMatrix()}update(e){const t=w();b(t,this.velocity,e),u(this.position,this.position,t),u(this.target,this.target,t),b(this.velocity,this.velocity,.9),this.updateViewMatrix()}}class le{constructor(e,t,i){B(this,"gl");B(this,"program");this.gl=e;const n=this.createShader(e.VERTEX_SHADER,t),s=this.createShader(e.FRAGMENT_SHADER,i);this.program=this.createProgram(n,s)}createShader(e,t){const i=this.gl.createShader(e);if(this.gl.shaderSource(i,t),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw console.error(this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),new Error("Shader compilation failed");return i}createProgram(e,t){const i=this.gl.createProgram();if(this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),!this.gl.getProgramParameter(i,this.gl.LINK_STATUS))throw console.error(this.gl.getProgramInfoLog(i)),this.gl.deleteProgram(i),new Error("Program linking failed");return i}use(){this.gl.useProgram(this.program)}setUniformMatrix4fv(e,t){const i=this.gl.getUniformLocation(this.program,e);this.gl.uniformMatrix4fv(i,!1,t)}setAttribute(e,t,i,n,s,a,o){const l=this.gl.getAttribLocation(this.program,e);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.vertexAttribPointer(l,i,n,s,a,o),this.gl.enableVertexAttribArray(l)}}class ce{constructor(e,t,i){B(this,"vertices");B(this,"indices");B(this,"position");B(this,"rotation");B(this,"modelMatrix");B(this,"gl");B(this,"positionBuffer");B(this,"colorBuffer");B(this,"normalBuffer");B(this,"indexBuffer");this.gl=e,this.vertices=t,this.indices=i,this.position=w(),this.rotation=w(),this.modelMatrix=T(),this.positionBuffer=null,this.colorBuffer=null,this.normalBuffer=null,this.indexBuffer=null,this.createBuffers()}createBuffers(){const e=new Float32Array(this.vertices.flatMap(n=>Array.from(n.position))),t=new Float32Array(this.vertices.flatMap(n=>n.color)),i=new Float32Array(this.vertices.flatMap(n=>Array.from(n.normal)));this.positionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),this.colorBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),this.normalBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.normalBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.indexBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW)}setAttributes(e){this.positionBuffer&&e.setAttribute("a_position",this.positionBuffer,3,this.gl.FLOAT,!1,0,0),this.colorBuffer&&e.setAttribute("a_color",this.colorBuffer,4,this.gl.FLOAT,!1,0,0),this.normalBuffer&&e.setAttribute("a_normal",this.normalBuffer,3,this.gl.FLOAT,!1,0,0)}setPosition(e,t,i){H(this.position,e,t,i),this.updateModelMatrix()}getPosition(){return this.position}setRotation(e,t,i){H(this.rotation,e,t,i),this.updateModelMatrix()}getRotation(){return this.rotation}move(e,t,i){u(this.position,this.position,F(e,t,i)),this.updateModelMatrix()}rotate(e,t,i){u(this.rotation,this.rotation,F(e,t,i)),this.updateModelMatrix()}updateModelMatrix(){q(this.modelMatrix),Q(this.modelMatrix,this.modelMatrix,this.position),ee(this.modelMatrix,this.modelMatrix,this.rotation[0]),re(this.modelMatrix,this.modelMatrix,this.rotation[1]),te(this.modelMatrix,this.modelMatrix,this.rotation[2])}getModelMatrix(){return this.modelMatrix}getVertices(){return this.vertices}getIndices(){return this.indices}}function he(r){const e=(1+Math.sqrt(5))/2;return[F(-1,e,0),F(1,e,0),F(-1,-e,0),F(1,-e,0),F(0,-1,e),F(0,1,e),F(0,-1,-e),F(0,1,-e),F(e,0,-1),F(e,0,1),F(-e,0,-1),F(-e,0,1)].map(i=>(S(i,i),b(i,i,r),{position:i,color:[1,1,1,1],normal:G(i)}))}function fe(){return new Uint16Array([0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1])}function de(r,e,t){const i=new Map;function n(a,o){const l=a<o?`${a}-${o}`:`${o}-${a}`;if(i.has(l))return i.get(l);const d=r[a].position,c=r[o].position,h=w();u(h,d,c),b(h,h,.5),S(h,h),b(h,h,t);const g=r.length;return r.push({position:h,color:[1,1,1,1],normal:G(h)}),i.set(l,g),g}const s=[];for(let a=0;a<e.length;a+=3){const o=e[a],l=e[a+1],d=e[a+2],c=n(o,l),h=n(l,d),g=n(d,o);s.push(o,c,g),s.push(l,h,c),s.push(d,g,h),s.push(c,h,g)}return{vertices:r,indices:new Uint16Array(s)}}function ge(r,e,t,i){let n=he(e),s=fe();for(let a=0;a<t;a++)({vertices:n,indices:s}=de(n,s,e));return n.forEach(a=>a.color=i),new ce(r,n,s)}const ve=`#version 300 es
in vec4 a_position;
in vec4 a_color;
in vec3 a_normal;
uniform mat4 u_matrix;
out vec4 v_color;
out vec3 v_normal;
void main() {
    gl_Position = u_matrix * a_position;
    v_color = a_color;
    v_normal = mat3(u_matrix) * a_normal;
}`,me=`#version 300 es
precision mediump float;

in vec3 v_normal;  // Normal from vertex shader
in vec4 v_color;   // Base color from vertex shader

out vec4 FragColor; // Final color output

void main() {
    // Define lighting properties
    vec3 lightDir = normalize(vec3(0.0, 1.0, 0.0)); // Light direction
    vec3 normal = normalize(v_normal); // Normalize the normal vector

    float ambientStrength = 1.0; // Ambient light intensity
    vec3 ambient = v_color.rgb * ambientStrength; // Ambient lighting component

    // Compute diffuse lighting using Lambertian reflectance
    float diff = max(dot(normal, lightDir), 0.0);
    vec3 diffuse = v_color.rgb * diff;

    // Combine ambient and diffuse lighting
    vec3 finalColor = ambient + diffuse;

    // Output final shaded color
    FragColor = vec4(finalColor, v_color.a);
}`;function pe(){const r=document.createElement("canvas");document.body.appendChild(r);const e=r.getContext("webgl2");if(!e){console.error("WebGL2 not supported");return}const t=new oe(Math.PI/4,r.width/r.height,.1,10);function i(){r.width=window.innerWidth,r.height=window.innerHeight,e&&e.viewport(0,0,r.width,r.height),t.updateProjectionMatrix(r.width/r.height)}window.addEventListener("resize",i),i();const n=new le(e,ve,me);n.use(),e.enable(e.DEPTH_TEST),e.clearColor(0,0,0,1);const a=ge(e,.5,3,[1,0,1,1]);a.setAttributes(n);const o=new Float32Array(a.getVertices().flatMap(f=>Array.from(f.position))),l=new Float32Array(a.getVertices().flatMap(f=>f.color)),d=new Float32Array(a.getVertices().flatMap(f=>Array.from(f.normal))),c=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,o,e.STATIC_DRAW);const h=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,l,e.STATIC_DRAW);const g=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,g),e.bufferData(e.ARRAY_BUFFER,d,e.STATIC_DRAW);const v=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,v),e.bufferData(e.ELEMENT_ARRAY_BUFFER,a.getIndices(),e.STATIC_DRAW),n.setAttribute("a_position",c,3,e.FLOAT,!1,0,0),n.setAttribute("a_color",h,4,e.FLOAT,!1,0,0),n.setAttribute("a_normal",g,3,e.FLOAT,!1,0,0),t.moveForward(0),t.lookAt(F(0,0,0));let R=0,M=!0;window.addEventListener("keydown",f=>{switch(console.log(f.key),f.key){case"w":t.moveForward(.1);break;case"s":t.moveBackward(.1);break;case"F1":M=!M}});let x=!1,y=0,_=0;r.addEventListener("mousedown",f=>{x=!0,y=f.clientX,_=f.clientY}),r.addEventListener("mouseup",()=>{x=!1}),r.addEventListener("mousemove",f=>{if(x){const m=f.clientX-y,p=f.clientY-_;y=f.clientX,_=f.clientY,t.rotate(m,p)}});function A(f){if(!e)return;const m=(f-R)*.001;R=f,t.update(m);const p=.01;a.rotate(p*m,p*m,p*m);const E=t.getFinalMatrix();W(E,E,a.getModelMatrix()),n.setUniformMatrix4fv("u_matrix",new Float32Array(E)),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.enable(e.DEPTH_TEST),M?e.drawElements(e.LINES,a.getIndices().length,e.UNSIGNED_SHORT,0):e.drawElements(e.TRIANGLES,a.getIndices().length,e.UNSIGNED_SHORT,0),requestAnimationFrame(A)}requestAnimationFrame(A)}pe();
